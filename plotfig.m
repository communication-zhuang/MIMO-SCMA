%%  iter_EP = 5   Nt = 1  Nr = 4
clc;
clear

SNREP1 = -7:15;
SNREP2 = -7:12;
SNREP4 = -7:9;
SNRMPA1 = -7:14;
SNRMPA2 = -7:10;
SNRMPA4 = -7:5;
SNRBSMP1 = -7:15;
SNRBSMP2 = -7:12;
SNRBSMP4 = -7:5;
BsMP1 = [0.313628899835796,0.305555555555556,0.310833333333333,0.288617886178862,0.282926829268293,0.261731391585761,0.263095238095238,0.242822966507177,0.254761904761905,...
         0.249217527386541,0.230620155038760,0.220542635658915,0.211509715994021,0.229646697388633,0.186541143654114,0.186475409836066,0.160909090909091,0.161533816425121,0.141479099678457,0.140092879256966,0.121555555555556,0.0973193473193473,0.0851377952755906];
BsMP2 = [0.249608763693271,0.254006410256410,0.214285714285714,0.198540706605223,0.164529914529915,0.150793650793651,0.130555555555556,0.117437722419929,0.100047080979284,...
         0.0775043177892919,0.0665607344632768,0.0437116564417178,0.0366962774957699,0.0228658536585366,0.0148900169204738,0.00837296868806976,0.00525456114398422,0.00260316236020054,0.00151429598069914,0.000719702129591790];
BsMP4 = [0.143049932523617,0.119455006337136,0.100174216027875,0.0734011627906977,0.0518480492813142,0.0373427672955975,0.0229625918503674,0.0134342186534898,0.00821227588012040,...
         0.00296945701357466,0.00135078969243558,0.000571061635442095,0.000138114128308025];
EP1 = [0.320066334991708	0.304258804258804	0.279021558872305	0.260616987179487	0.262390087929656	0.243189102564103	0.217432950191571	0.205729166666667	...
       0.184536447275301	0.171812749003984	0.161056105610561	0.148299939283546	0.127916666666667	0.117191404297851	0.0980126467931346	0.0827783943766186	0.0758096172718351	0.0586140783347028	0.0562997827661115	0.0480466288594833	0.0417589516426726	0.0386148480318884	0.0342972897457390];
EP2 = [0.226531424025457	0.205275229357798	0.195919938414165	0.160055671537926	0.149728997289973	0.119707811568277	0.104673149648838	0.0778652668416448	...
       0.0605253816116436	0.0476288944030880	0.0351761352066789	0.0258205008554985	0.0165313225058005	0.0120298382013028	0.00953330266319072	0.00727505640319682	0.00616065142192427	0.00545769949292768	0.00514615855524946	0.00446204909819639];
EP4 = [0.128700128700129	0.110963356973995	0.0882043180621380	0.0652085864722560	0.0460285809238950	0.0277949034114262	0.0189588688946015	0.0110365104440934 ...
       0.00572231359649123	0.00357998367948617	0.00190555671465331	0.00127784320112250	0.000883807338196323	0.000795096423511724	0.000746936016945660	0.000603810117211184	0.000552333609500138];
MPA1 = [0.330833333333333,0.313847429519071,0.320197044334975,0.282852564102564,0.263492063492064,0.254263565891473,0.217717717717718,0.219696969696970,0.200068870523416,...
       0.186197916666667,0.162918108419839,0.123663751214772,0.0957354221061793,0.0838756326825741,0.0672727272727273,0.0419614779874214,0.0303502523003859,0.0229136517124940,0.0129490392648287,0.00835475578406170,0.00497979625519322,0.00285135083930128];
MPA2 =[0.238268608414239,0.221966205837174,0.192846607669617,0.174145299145299,0.161175710594315,0.129079254079254,0.103853853853854,0.0735411670663469,0.0533653846153846,...
       0.0373638344226580,0.0248091603053435,0.0135440180586907,0.00907622739018088,0.00539906103286385,0.00252002606262696,0.00109332522837411,0.000586359627443569,0.000249622954449555];  
MPA4 = [0.138000000000000,0.109916367980884,0.0798918387413963,0.0730533683289589,0.0485000000000000,0.0330597355221158,0.0185881370091896,0.00992160705536502, ...
        0.00483766496639948,0.00236232377064671,0.000990269525531732,0.000332336324360253,0.000105985162077309];
  

% s0 = semilogy(SNREP1, EP1, '-^', 'linewidth', 1.5);
% set(s0,'Color',[128,0,128]/256)
% hold on;
%  
% s5 = semilogy(SNREP2, EP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s6 = semilogy(SNREP4, EP4, '-^', 'linewidth', 1.5);
% set(s6,'Color',[255 62 150]/256)
% 
% 
% s4 = semilogy(SNRMPA1, MPA1, '-s', 'linewidth', 1.5);
% set(s4,'Color',[128,0,128]/256)
% 
% s3 = semilogy(SNRMPA2, MPA2, '-s', 'linewidth', 1.5);
% set(s3,'Color',[0 161 241]/256)
% 
% s2 = semilogy(SNRMPA4, MPA4, '-s', 'linewidth', 1.5);
% set(s2,'Color',[255 62 150]/256)
% 
% s7 = semilogy(SNRBSMP1, BsMP1, '-h', 'linewidth', 1.5);
% set(s7,'Color',[128,0,128]/256)
% hold on;
%  
% s8 = semilogy(SNRBSMP2, BsMP2, '-h', 'linewidth', 1.5);
% set(s8,'Color',[0 161 241]/256)
% 
% 
% s9 = semilogy(SNRBSMP4, BsMP4, '-h', 'linewidth', 1.5);
% set(s9,'Color',[255 62 150]/256)

s0 = semilogy(SNREP1, EP1, '-^', 'linewidth', 1.5);
set(s0,'Color',[128,0,128]/256)
hold on;
 
s5 = semilogy(SNREP2, EP2, '-s', 'linewidth', 1.5);
set(s5,'Color',[128,0,128]/256)


s6 = semilogy(SNREP4, EP4, '-h', 'linewidth', 1.5);
set(s6,'Color',[128,0,128]/256)


s4 = semilogy(SNRMPA1, MPA1, '-^', 'linewidth', 1.5);
set(s4,'Color',[0 161 241]/256)

s3 = semilogy(SNRMPA2, MPA2, '-s', 'linewidth', 1.5);
set(s3,'Color',[0 161 241]/256)

s2 = semilogy(SNRMPA4, MPA4, '-h', 'linewidth', 1.5);
set(s2,'Color',[0 161 241]/256)

s7 = semilogy(SNRBSMP1, BsMP1, '-^', 'linewidth', 1.5);
set(s7,'Color',[255 62 150]/256)
hold on;
 
s8 = semilogy(SNRBSMP2, BsMP2, '-s', 'linewidth', 1.5);
set(s8,'Color',[255 62 150]/256)


s9 = semilogy(SNRBSMP4, BsMP4, '-h', 'linewidth', 1.5);
set(s9,'Color',[255 62 150]/256)


% 
grid on;
%title('Comparision of BER for different antennas','interpreter','latex');
legend('EP,$N_t=1,N_r=1$','EP,$N_t=1,N_r=2$','EP,$N_t=1,N_r=4$','MPA,$N_t=1,N_r=1$','MPA,$N_t=1,N_r=2$','MPA,$N_t=1,N_r=4$','BsMP,$N_t=1,N_r=1$',...
        'BsMP,$N_t=1,N_r=2$','BsMP,$N_t=1,N_r=4$','interpreter','latex');
axis([-7, 15, 8e-05, 0.4]);
xlabel('SNR[dB]', 'interpreter','latex');
ylabel('BER', 'interpreter','latex');




% s0 = semilogy(SNREP1, EP1, '-*', 'linewidth', 1.5);
% set(s0,'Color',[252 170 103]/256)
% hold on;
%  
% s5 = semilogy(SNREP2, EP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s6 = semilogy(SNREP4, EP4, '-d', 'linewidth', 1.5);
% set(s6,'Color',[128 41 41]/256)
% 
% 
% s4 = semilogy(SNRMPA1, MPA1, '-s', 'linewidth', 1.5);
% set(s4,'Color',[256 0 0]/256)
% 
% s3 = semilogy(SNRMPA2, MPA2, '-h', 'linewidth', 1.5);
% set(s3,'Color',[128,0,128]/256)
% 
% s2 = semilogy(SNRMPA4, MPA4, '-<', 'linewidth', 1.5);
% set(s2,'Color',[255 62 150]/256)
% 
% s7 = semilogy(SNRBSMP1, BsMP1, '-*', 'linewidth', 1.5);
% set(s0,'Color',[252 170 103]/256)
% hold on;
%  
% s8 = semilogy(SNRBSMP2, BsMP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s9 = semilogy(SNRBSMP4, BsMP4, '-d', 'linewidth', 1.5);
% set(s6,'Color',[128 41 41]/256)



%%  iter_EP = 5   Nt = 1  Nr = 4
clc;
clear




SNRMPA1 = -7:14;
SNRMPA2 = -7:10;
SNRMPA4 = -7:5;
SNRBSMP1 = -7:15;
SNRBSMP2 = -7:12;
SNRBSMP4 = -7:5;
BsMP1 = [0.313628899835796,0.305555555555556,0.310833333333333,0.288617886178862,0.282926829268293,0.261731391585761,0.263095238095238,0.242822966507177,0.254761904761905,...
         0.249217527386541,0.230620155038760,0.220542635658915,0.211509715994021,0.229646697388633,0.186541143654114,0.186475409836066,0.160909090909091,0.161533816425121,0.141479099678457,0.140092879256966,0.121555555555556,0.0973193473193473,0.0851377952755906];
BsMP2 = [0.249608763693271,0.254006410256410,0.214285714285714,0.198540706605223,0.164529914529915,0.150793650793651,0.130555555555556,0.117437722419929,0.100047080979284,...
         0.0775043177892919,0.0665607344632768,0.0437116564417178,0.0366962774957699,0.0228658536585366,0.0148900169204738,0.00837296868806976,0.00525456114398422,0.00260316236020054,0.00151429598069914,0.000719702129591790];
BsMP4 = [0.143049932523617,0.119455006337136,0.100174216027875,0.0734011627906977,0.0518480492813142,0.0373427672955975,0.0229625918503674,0.0134342186534898,0.00821227588012040,...
         0.00296945701357466,0.00135078969243558,0.000571061635442095,0.000138114128308025];
MPA1 = [0.330833333333333,0.313847429519071,0.320197044334975,0.282852564102564,0.263492063492064,0.254263565891473,0.217717717717718,0.219696969696970,0.200068870523416,...
       0.186197916666667,0.162918108419839,0.123663751214772,0.0957354221061793,0.0838756326825741,0.0672727272727273,0.0419614779874214,0.0303502523003859,0.0229136517124940,0.0129490392648287,0.00835475578406170,0.00497979625519322,0.00285135083930128];
MPA2 =[0.238268608414239,0.221966205837174,0.192846607669617,0.174145299145299,0.161175710594315,0.129079254079254,0.103853853853854,0.0735411670663469,0.0533653846153846,...
       0.0373638344226580,0.0248091603053435,0.0135440180586907,0.00907622739018088,0.00539906103286385,0.00252002606262696,0.00109332522837411,0.000586359627443569,0.000249622954449555];  
MPA4 = [0.138000000000000,0.109916367980884,0.0798918387413963,0.0730533683289589,0.0485000000000000,0.0330597355221158,0.0185881370091896,0.00992160705536502, ...
        0.00483766496639948,0.00236232377064671,0.000990269525531732,0.000332336324360253,0.000105985162077309];
  

% s0 = semilogy(SNREP1, EP1, '-^', 'linewidth', 1.5);
% set(s0,'Color',[128,0,128]/256)
% hold on;
%  
% s5 = semilogy(SNREP2, EP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s6 = semilogy(SNREP4, EP4, '-^', 'linewidth', 1.5);
% set(s6,'Color',[255 62 150]/256)
% 
% 
% s4 = semilogy(SNRMPA1, MPA1, '-s', 'linewidth', 1.5);
% set(s4,'Color',[128,0,128]/256)
% 
% s3 = semilogy(SNRMPA2, MPA2, '-s', 'linewidth', 1.5);
% set(s3,'Color',[0 161 241]/256)
% 
% s2 = semilogy(SNRMPA4, MPA4, '-s', 'linewidth', 1.5);
% set(s2,'Color',[255 62 150]/256)
% 
% s7 = semilogy(SNRBSMP1, BsMP1, '-h', 'linewidth', 1.5);
% set(s7,'Color',[128,0,128]/256)
% hold on;
%  
% s8 = semilogy(SNRBSMP2, BsMP2, '-h', 'linewidth', 1.5);
% set(s8,'Color',[0 161 241]/256)
% 
% 
% s9 = semilogy(SNRBSMP4, BsMP4, '-h', 'linewidth', 1.5);
% set(s9,'Color',[255 62 150]/256)




s4 = semilogy(SNRMPA1, MPA1, '-^', 'linewidth', 1.5);
set(s4,'Color',[0 161 241]/256)
hold on;

s3 = semilogy(SNRMPA2, MPA2, '-s', 'linewidth', 1.5);
set(s3,'Color',[0 161 241]/256)

s2 = semilogy(SNRMPA4, MPA4, '-h', 'linewidth', 1.5);
set(s2,'Color',[0 161 241]/256)

s7 = semilogy(SNRBSMP1, BsMP1, '-^', 'linewidth', 1.5);
set(s7,'Color',[255 62 150]/256)
hold on;
 
s8 = semilogy(SNRBSMP2, BsMP2, '-s', 'linewidth', 1.5);
set(s8,'Color',[255 62 150]/256)


s9 = semilogy(SNRBSMP4, BsMP4, '-h', 'linewidth', 1.5);
set(s9,'Color',[255 62 150]/256)


% 
grid on;
%title('Comparision of BER for different antennas','interpreter','latex');
legend('MPA,$N_t=1,N_r=1$','MPA,$N_t=1,N_r=2$','MPA,$N_t=1,N_r=4$','BsMP,$N_t=1,N_r=1$',...
        'BsMP,$N_t=1,N_r=2$','BsMP,$N_t=1,N_r=4$','interpreter','latex');
axis([-7, 15, 8e-05, 0.4]);
xlabel('SNR[dB]', 'interpreter','latex');
ylabel('BER', 'interpreter','latex');




% s0 = semilogy(SNREP1, EP1, '-*', 'linewidth', 1.5);
% set(s0,'Color',[252 170 103]/256)
% hold on;
%  
% s5 = semilogy(SNREP2, EP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s6 = semilogy(SNREP4, EP4, '-d', 'linewidth', 1.5);
% set(s6,'Color',[128 41 41]/256)
% 
% 
% s4 = semilogy(SNRMPA1, MPA1, '-s', 'linewidth', 1.5);
% set(s4,'Color',[256 0 0]/256)
% 
% s3 = semilogy(SNRMPA2, MPA2, '-h', 'linewidth', 1.5);
% set(s3,'Color',[128,0,128]/256)
% 
% s2 = semilogy(SNRMPA4, MPA4, '-<', 'linewidth', 1.5);
% set(s2,'Color',[255 62 150]/256)
% 
% s7 = semilogy(SNRBSMP1, BsMP1, '-*', 'linewidth', 1.5);
% set(s0,'Color',[252 170 103]/256)
% hold on;
%  
% s8 = semilogy(SNRBSMP2, BsMP2, '-^', 'linewidth', 1.5);
% set(s5,'Color',[0 161 241]/256)
% 
% 
% s9 = semilogy(SNRBSMP4, BsMP4, '-d', 'linewidth', 1.5);
% set(s6,'Color',[128 41 41]/256)



%% iter= 6   Nt = 1  Nr = 4  coded system  code_R = 3/4  code_N = 648  SDD

SNREP4 = -7:9;
SNRMPA4 = -7:4;
SNRBSMP4 = -7:4;

EP4_uncoded = [0.133405349794239	0.113510802469136	0.0857253086419753	0.0645447530864198	0.0456809353486404	0.0312928669410151	0.0179479985035541	0.0109115849856591...
              0.00627334094683023	0.00330470177895158	0.00192491021030908	0.00117489154381106	0.000857648598843881	0.000687376882348104	0.000603617746199432	0.000523505012430212	0.000480796539711115];

EP4_coded = [0.131464334705075	0.109358710562414	0.0781481481481482	0.0501748971193416	0.0279155929900132	0.0140779430902888	0.00456104252400549	0.00144275401477048...
             0.000646217426594295	0.000202468673677108	0.000140892285128207	9.05821694211404e-05	0.000104000133995242	9.31429829463666e-05	8.21631397832336e-05	7.99862697708256e-05	6.15361490463029e-05];


MPA4_uncoded = [0.141630658436214	0.116705246913580	0.0908539094650206	0.0681995884773663	0.0473968225704337	0.0316083957363557	0.0187613080034057	0.00992895411134405...
                0.00491823190059260	0.00221707224930859	0.000921920795200122 0.000348621420580357];

MPA4_coded = [0.140510973936900	0.113539094650206	0.0833058984910837	0.0554561042524006	0.0296672206394429	0.0150441880860824	0.00496221796509153	0.00150350464815874...
              0.000345552246860083	8.22490868252565e-05	1.67725137035595e-05 3.47887110416672e-06];

BsMP4_uncoded = [0.147384259259259	0.122584876543210	0.0994444444444445	0.0763837448559671	0.0524176954732510	0.0370848355730362	0.0237214289255789	0.0130870705042392...
                 0.00670110644299435	0.00314366409634791	0.00130514098160461 0.000500380200329326];

BsMP4_coded = [0.146409465020576	0.119142661179698	0.0941289437585734	0.0662311385459534	0.0366392318244170	0.0204183206477536	0.00865189151668402	0.00271456195150974...
                0.000647245976646173	0.000134825725370891	2.68609630795029e-05 5.23694357518869e-06];




s6 = semilogy(SNREP4, EP4_uncoded, '-h', 'linewidth', 1.2);
set(s6,'Color',[128,0,128]/256)
hold on

s2 = semilogy(SNRMPA4, MPA4_uncoded, '-s', 'linewidth', 1.2);
set(s2,'Color',[128,0,128]/256)


s9 = semilogy(SNRBSMP4, BsMP4_uncoded, '-*', 'linewidth', 1.2);
set(s9,'Color',[128,0,128]/256)

s0 = semilogy(SNREP4, EP4_coded, '-h', 'linewidth', 1.2);
set(s0,'Color',[252 170 103]/256)

s3 = semilogy(SNRMPA4, MPA4_coded, '-s', 'linewidth', 1.2);
set(s3,'Color',[252 170 103]/256)


s1 = semilogy(SNRBSMP4, BsMP4_coded, '-*', 'linewidth', 1.2);
set(s1,'Color',[252 170 103]/256)


grid on;
%title('Comparision of BER for different antennas','interpreter','latex');
legend('GA,$N_t=1,N_r=4$','MPA,$N_t=1,N_r=4$','BsMP,$N_t=1,N_r=4$', 'EP4', ...
        'MPA with LDPC,$N_t=1,N_r=4$','BsMP with LDPC,$N_t=1,N_r=4$','interpreter','latex');
axis([-7, 4, 3e-06, 0.2]);
xlabel('SNR[dB]', 'interpreter','latex');
ylabel('BER', 'interpreter','latex');






